---
title: "模糊聚类分析"
date: "2023-02-04"
---
## 模糊聚类分析

最早是20世纪60年代的Zadeh提出的，将模糊集合的概念应用于聚类分析就可以得到关于模糊聚类分析。

### 模糊集

首先我们定义了一个模糊矩阵`$A$`，上面的元素`$a_{ij}$`表示的是矩阵的元素。与其对应的另一个模糊矩阵`$B$`

定义`$C=A\cdot B$`为`$n\times m$`矩阵，其元素为
$$
C_{ij}=\vee_{k=1}^p(a_{ik}\wedge b_{kj}),\quad i=1,2,\cdots,n;j=1,2,\cdots,m
$$
其中规定`$\vee$`表示析取，`$\wedge$`为合取，具体的数值计算为
$$
a\vee b=\max(a,b)\\
a\wedge b=\min(a,b)
$$


### 模糊关系

#### 乘积空间

n个样本的所有全体所组成的集合`$x$`作为全域。令`$X\times Y=\{(x,y)|x\in X,y\in Y\}$`，则称`$X\times Y$`为全域乘积空间。

#### 分类关系

对于分类关系的定义和我们在乘积空间中对距离的定义类似，首先需假设`$R$为$X\times Y$`上的一个集合。同时满足

- 反身性： `$(x,x)\in R$`，即集合中的每一个元素都是和它自己是一个类
- 对称性：IF `$(x,y)\in R$`, Then `$(y,x)\in R$`
- 传递性：IF `$(x,y)\in R,(y,z)\in R$`，Then `$(x,z)\in R$`

若满足这三条关系，就称为是一个分类关系。

### 模糊聚类

将模糊集融入聚类中，也就是根据对象本身的属性进行构造模糊矩阵。

假设`$X=(x_1,x_2,x_3)$`上的模糊矩阵
$$
R=\begin{bmatrix}1& .4 &0.6\\0.4&1 &0.4
\\0.6 &0.4&1
\end{bmatrix}
$$
是一个模糊分类关系，现在从R出发对X进行分类。

根据不同的阈值，首先将`$0<\lambda\le 1$`时候有
$$
R_\lambda=\begin{bmatrix}
1 & 0 &0\\
0 & 1 &0\\
0 & 0 &1
\end{bmatrix}
$$
可以看到其中的`$X=\{x_1\}\cup\{x_2\}\cup\{x_3\}$`各为一类。

进一步将`$0.4<\lambda\le 0.6$`可得到另一个划分。再`$\lambda<0.4$`可得到一个划分。



### 计算步骤

- 对原有的数据进行变化
- 计算模糊相似矩阵，选择在`$[-1,1]$`之间的普通相似系数(`$r_{ij}=cos(\theta)$`)构成的相似系数矩阵。

$$
r_{ij}=\frac{1+r_{ij}^*}{2}
$$

使得原始数据被压缩到`$[0,1]$`区间内。由此就可以构成一个模糊矩阵。

- 建立等价的举着，对模糊矩阵进行褶积计算。
- 进行聚类：给定不同的阈值`$(\lambda)$`，求`$R_\lambda$`截阵，找出`$R$`的`$\lambda$`显示。



所谓的聚类方法是一句模糊矩阵将所研究的对象进行分类的方法。对于不同的置信水平`$\lambda\in[0,1]$`可以得到不同的分类结果。从而形成动态聚类图。

具体的求解方法有：

传递闭包法：

从上述求解得到的模糊相似矩阵R出发，来构造一个模糊等价矩阵`$R^*$`，方法为用平方法求出`$R$`的传递闭包`$t(R)$`，则`$t(R)=R^*$`，之后由大到小选取一组`$\lambda\in[0,1]$`确定相应的`$\lambda$`矩阵，最后画出动态聚类图。

比如现有5组数据
$$\begin{aligned}
x_1=(80,10,6,2),x_2=(50,1,6,4),\\
x_3=(90,6,4,6),x_4=(40,5,7,3),\\
x_5=(10,1,2,4)
\end{aligned}
$$


先将其归一化处理，得到特性矩阵
$$
\boldsymbol{X}=\left(\begin{array}{cccc}
0.89 & 1 & 0.86 & 0.33 \\
0.56 & 0.10 & 0.86 & 0.67 \\
1 & 0.60 & 0.57 & 1 \\
0.44 & 0.5 & 1 & 0.5 \\
0.11 & 0.10 & 0.29 & 0.67
\end{array}\right)
$$
通过两次合成，得到传递闭包：
$$
t(R)=R^4=\left(\begin{array}{ccccc}
1 & 0.63 & 0.62 & 0.63 & 0.53 \\
0.63 & 1 & 0.62 & 0.70 & 0.53 \\
0.62 & 0.62 & 1 & 0.62 & 0.53 \\
0.63 & 0.70 & 0.62 & 1 & 0.53 \\
0.53 & 0.53 & 0.53 & 0.53 & 1
\end{array}\right)
$$
对所有的元素进行排序：
$$
1>0.70>0.63>0.62>0.53
$$
因此依次取`$\lambda$`截矩阵，便可得到聚类结果：

- `$\lambda=1$`时候，`$X$`被分为5类`$\{x_1\},\{x_2\},\{x_3\},\{x_4\},\{x_5\}$`

- `$\lambda=0.7$`时候，`$X$`被划分为4类
- `$\lambda=0.63$`时候，`$X$`被划分为3类
- `$\lambda=0.62$`时候，`$X$`被划分为2类
- `$\lambda=0.53$`时候，`$X$`被划分为1类



另一个方法是直接聚类法：

与传递闭包法的差异在于并不需要计算传递闭包，而是直接由相似矩阵进行聚类。
$$
1>0.70>0.63>0.62>0.56>0.55>0.54>0.53>0.38>0.37>0.24
$$
类似于传递闭包的方法，此时仍然需要考虑`$\lambda=1,0.7,0.63,0.62$`的聚类。上述方法已经将这些聚类结果给出，只需要考虑后面的聚类：

- `$\lambda=0.56,0.55,0.54$`时候，`$X$`被分为2类`$\{x_1,x_2,x_3,x_4\},\{x_5\}$`
